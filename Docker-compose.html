<!DOCTYPE html><html lang="en" data-theme="light"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Docker-compose - Êú™ÂëΩÂêçÊñáÊ°£</title>
    
    
        <script src="asset/theme.js"></script>
    
<link rel="stylesheet" type="text/css" href="asset/plugins/theme-classic/844.index.css"><style data-rh="true">
:root {
    --ttw-primary-color: #21ba45;
}
</style><link rel="stylesheet" type="text/css" href="asset/plugins/highlight/81.index.css"><script charset="utf-8" data-webpack="TopWritePlugins = typeof TopWritePlugins === &quot;undefined&quot; ? {} : TopWritePlugins; TopWritePlugins['highlight']:chunk-81" src="asset/plugins/highlight/81.index.js"></script></head>
<body style="overflow: visible;">
<div id="root"><div class="navbar--a15beafa"><div class="inner--688a1365"><div class="items--bcfe621f"><a class="brand--50bec894" href="."><img class="logo--9f373004" src="logo.png" width="60" height="60" alt="logo"><strong class="title--ed7bbad8">Êú™ÂëΩÂêçÊñáÊ°£</strong></a></div><div class="items--bcfe621f"><div class="react-toggle"><div class="react-toggle-track"><div class="react-toggle-track-check">üåú</div><div class="react-toggle-track-x">üåû</div></div><div class="react-toggle-thumb"></div><input class="react-toggle-screenreader-only" type="checkbox"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><span class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></span><span class="DocSearch-Button-Key">K</span></span></button></div></div><div class="sidebar-backdrop--5a61f01d"></div><div class="sidebar--7ae7ff6a"><div class="sidebar-brand--045ce82b"><a class="brand--50bec894" href="."><img class="logo--9f373004" src="logo.png" width="60" height="60" alt="logo"><strong class="title--ed7bbad8">Êú™ÂëΩÂêçÊñáÊ°£</strong></a></div><div class="items--bcfe621f"></div></div></div><div class="page--f0f6908e"><div class="sidebar--fef9f737"><span class="button--8dedf7c3"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M64 384h384v-42.67H64zm0-106.67h384v-42.66H64zM64 128v42.67h384V128z"></path></svg></span><div class="catalog--ef2f939c"><div><ul><li class=""><div class="item--1a209e5a"><a href="IDE.html">IDE Integration</a></div></li><li class="open--938f5b49"><div class="item--1a209e5a active--c09d7805"><a href="Docker-compose.html">Docker-compose</a></div></li><li class=""><div class="item--1a209e5a"><a href="Schema.html">Images Schema</a></div></li><li class=""><div class="item--1a209e5a"><a href="Pipeline.html">Production image Pipeline</a></div></li></ul></div></div></div><div class="article--df0ce560"><div class="container--9c0374e9"><article><h1>Docker-compose</h1><h1><a aria-hidden="true" tabindex="-1" class="anchor" id="using-docker-compose"></a>Using Docker Compose</h1><p>Minimal Configuration:</p><pre><code class="language-YAML">version: '2'
services:
  fpm:
      image: jorge07/alpine-php:7-dev
      ports:
        - "2244:22"
        - "9000:9000"
      volumes:
        - "$PWD:/app"
</code></pre><p>You can optionally add ENV params:</p><pre><code class="language-YAML">
 ...
   fpm:
      environment:
        - PHP_IDE_CONFIG=serverName=SomeName
</code></pre><h1><a aria-hidden="true" tabindex="-1" class="anchor" id="nginx-integration"></a>Nginx integration</h1><p>This example is based on a <a href="http://symfony.com/">Symfony</a> project but can be what you want. Full example <a href="https://github.com/jorge07/ddd-playground">here</a></p><p>Project structure:</p><p><img src="https://raw.githubusercontent.com/jorge07/alpine-php/master/doc/images/folder-structure.png" alt="Tree"></p><p><em>etc/infrastructure/dev/nginx/demo.conf</em></p><pre><code class="language-nginx">server {
 &nbsp;server_name demo.dev www.demo.dev;
  root /app/web;

  location / {
     try_files $uri /app_dev.php$is_args$args;
  }

  location ~ ^/(app|app_dev|config)\.php(/|$) {

     fastcgi_pass fpm:9000;
     fastcgi_split_path_info ^(.+\.php)(/.*)$;
     include fastcgi_params;

     fastcgi_param  SCRIPT_FILENAME  $realpath_root$fastcgi_script_name;
     fastcgi_param DOCUMENT_ROOT $realpath_root;
  }
}
</code></pre><p><em>etc/infrastructure/dev/nginx/Dockerfile</em></p><pre><code class="language-Dockerfile"> FROM nginx:1.11-alpine

 COPY demo.conf /etc/nginx/conf.d/default.conf
</code></pre><p><em>/etc/infrastructure/dev/docker-compose.yml</em></p><pre><code class="language-YAML"> version: '2'
 services:
   nginx:
     build: nginx
     depends_on:
       - fpm
     ports:
       - "80:80"
     volumes:
       - "$PWD/web:/app/web"

   fpm:
     image: jorge07/alpine-php:7-dev
     ports:
       - "2244:22"
       - "9000:9000"
     volumes:
       - "$PWD:/app"
</code></pre><p>Up enviroment</p><pre><code> $ docker-compose -f /etc/infrastructure/dev/docker-compose.yml up -d
 
</code></pre><div class="pagination--369abd3a"><div class="item--1a209e5a"><a href="IDE.html"><div class="sub-label--5b72bdf2">Previous</div><div class="label--ce6da7fd">¬´ IDE Integration</div></a></div><div class="item--1a209e5a"><a href="Schema.html"><div class="sub-label--5b72bdf2">Next</div><div class="label--ce6da7fd">Images Schema ¬ª</div></a></div></div></article><aside><ul><li><a href="#using-docker-compose">Using Docker Compose</a></li><li><a href="#nginx-integration">Nginx integration</a></li></ul></aside></div></div></div><footer class="footer--64c13cc4"><div class="container--1593c272"><div class="powerby--d1608b4c">Êú¨ÊñáÊ°£‰ΩøÁî® <a href="https://x.topthink.com" target="_blank">È°∂ÊÉ≥‰∫ë</a> ÊûÑÂª∫</div></div></footer></div>
<script type="application/payload+json">
{"book":{"id":"10"},"summary":[{"title":"Available documentation","articles":[{"title":"IDE Integration","ref":"IDE.md","path":"IDE.html","children":[]},{"title":"Docker-compose","ref":"Docker-compose.md","path":"Docker-compose.html","children":[]},{"title":"Images Schema","ref":"Schema.md","path":"Schema.html","children":[]},{"title":"Production image Pipeline","ref":"Pipeline.md","path":"Pipeline.html","children":[]}]}],"config":{"structure":{"summary":"README.md"},"root":"doc","theme":"classic","plugins":["highlight","tex"]},"file":{"path":"Docker-compose.html","content":"# Using Docker Compose\n\nMinimal Configuration:\n\n```YAML\nversion: '2'\nservices:\n  fpm:\n      image: jorge07\/alpine-php:7-dev\n      ports:\n        - \"2244:22\"\n        - \"9000:9000\"\n      volumes:\n        - \"$PWD:\/app\"\n```\n\nYou can optionally add ENV params:\n\n```YAML\n\n ...\n   fpm:\n      environment:\n        - PHP_IDE_CONFIG=serverName=SomeName\n```\n\n# Nginx integration\n\nThis example is based on a [Symfony](http:\/\/symfony.com\/) project but can be what you want. Full example [here](https:\/\/github.com\/jorge07\/ddd-playground)\n\nProject structure:\n\n![Tree](https:\/\/raw.githubusercontent.com\/jorge07\/alpine-php\/master\/doc\/images\/folder-structure.png)\n\n*etc\/infrastructure\/dev\/nginx\/demo.conf*\n\n```nginx\nserver {\n ¬†server_name demo.dev www.demo.dev;\n  root \/app\/web;\n\n  location \/ {\n     try_files $uri \/app_dev.php$is_args$args;\n  }\n\n  location ~ ^\/(app|app_dev|config)\\.php(\/|$) {\n\n     fastcgi_pass fpm:9000;\n     fastcgi_split_path_info ^(.+\\.php)(\/.*)$;\n     include fastcgi_params;\n\n     fastcgi_param  SCRIPT_FILENAME  $realpath_root$fastcgi_script_name;\n     fastcgi_param DOCUMENT_ROOT $realpath_root;\n  }\n}\n```\n\n*etc\/infrastructure\/dev\/nginx\/Dockerfile*\n\n```Dockerfile\n FROM nginx:1.11-alpine\n\n COPY demo.conf \/etc\/nginx\/conf.d\/default.conf\n```\n\n*\/etc\/infrastructure\/dev\/docker-compose.yml*\n\n```YAML\n version: '2'\n services:\n   nginx:\n     build: nginx\n     depends_on:\n       - fpm\n     ports:\n       - \"80:80\"\n     volumes:\n       - \"$PWD\/web:\/app\/web\"\n\n   fpm:\n     image: jorge07\/alpine-php:7-dev\n     ports:\n       - \"2244:22\"\n       - \"9000:9000\"\n     volumes:\n       - \"$PWD:\/app\"\n```\n\nUp enviroment\n\n```\n $ docker-compose -f \/etc\/infrastructure\/dev\/docker-compose.yml up -d\n \n```\n\n","meta":{"mtime":""}},"options":{}}
</script>

<script src="https://jsdelivr.topthink.com/npm/lodash@4.17/lodash.min.js"></script>

<script src="https://jsdelivr.topthink.com/npm/react@17/umd/react.production.min.js"></script>

<script src="https://jsdelivr.topthink.com/npm/react-dom@17/umd/react-dom.production.min.js"></script>

<script src="asset/index.js"></script>

<script src="asset/plugins/highlight/index.js"></script>

<script src="asset/plugins/tex/index.js"></script>

<script src="asset/plugins/theme-classic/index.js"></script>

<script type="text/javascript">
    TopWrite.bootstrap();
</script>


</body></html>